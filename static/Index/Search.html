<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Search Model 107</title>
    <style>
        body {
            background-color: #000000;
            color: #0000ff;
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        a {
            color: #66ccff;
        }
        a:visited {
            color: #ff9999;
        }
        a:active {
            color: #cccccc;
        }
        .search-container {
            text-align: center;
            margin: 20px auto;
            max-width: 600px;
        }
        .search-input {
            width: 80%;
            padding: 10px;
            margin: 10px;
            font-size: 16px;
        }
        .search-button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #0099ff;
            color: white;
            border: none;
            cursor: pointer;
        }
        .results {
            margin: 20px auto;
            max-width: 800px;
        }
        .result-item {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #0099ff;
        }
    </style>
</head>
<body>
    <h2><center>
        <hr>
        <span style="color: #0099ff; font-size: larger;">Mercedes-Benz Model 107<br>
        Maintenance Manuals Search</span><br>
    </center></h2>

    <div class="search-container">
        <input type="text" id="searchInput" class="search-input" placeholder="Enter search terms...">
        <button onclick="performSearch()" class="search-button">Search</button>
    </div>

    <div id="searchResults" class="results"></div>

    <hr>
    <p><center>Copyright &copy; 2003, 2004 Steve Nervig.<br>All Rights Reserved</center></p>

    <script>
        async function performSearch() {
            const searchInput = document.getElementById('searchInput');
            const resultsDiv = document.getElementById('searchResults');
            const query = searchInput.value.trim();

            if (!query) {
                resultsDiv.innerHTML = '<p>Please enter a search term</p>';
                return;
            }

            try {
                const response = await fetch('/search', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ query: query })
                });

                const data = await response.json();

                if (data.hits && data.hits.length > 0) {
                    const resultsHtml = data.hits.map(hit => {
                        // Remove the leading "static/" from the ID to create the proper link
                        const path = hit.id.replace(/^static\//, '');
                        return `
                            <div class="result-item">
                                <a href="/${path}">${path}</a>
                                <div>Score: ${hit.score.toFixed(3)}</div>
                            </div>
                        `;
                    }).join('');

                    resultsDiv.innerHTML = `
                        <h3>Found ${data.total_hits} results</h3>
                        ${resultsHtml}
                    `;
                } else {
                    resultsDiv.innerHTML = '<p>No results found</p>';
                }
            } catch (error) {
                resultsDiv.innerHTML = '<p>Error performing search. Please try again.</p>';
                console.error('Search error:', error);
            }
        }

        // Allow Enter key to trigger search
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });
    </script>
</body>
</html>
